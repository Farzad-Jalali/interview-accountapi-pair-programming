version: '2'
services:
  sqs:
    image: 288840537196.dkr.ecr.eu-west-1.amazonaws.com/tech.form3/elasticmq
    ports:
    - "${SQS_PORT}:1212"
    volumes:
    - ./sqs/queues.conf:/queues.conf
    environment:
      BIND_PORT: 1212
  sns:
    image: 288840537196.dkr.ecr.eu-west-1.amazonaws.com/tech.form3/sns
    depends_on:
    - sqs
    - wait_for
    ports:
    - "${SNS_PORT}:9911"
    volumes:
    - ./sns/sns.json:/etc/sns/db.json.template
    environment:
      SQS_PORT: 1212
      SQS_HOST: sqs

  wait_for:
    image: dadarek/wait-for-dependencies
    depends_on:
    - sqs
    command: sqs:1212